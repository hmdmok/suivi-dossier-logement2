{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\moknial01\\\\Documents\\\\suivi-dossier-logement2\\\\src\\\\Components\\\\FileUpload\\\\FileUpload.js\",\n    _s = $RefreshSig$();\n\nimport React, { Fragment, useState } from \"react\";\nimport Message from \"../Message/Message\";\nimport Progress from \"../ScanDossier/Progress\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst FileUpload = _ref => {\n  _s();\n\n  let {\n    titleFilename,\n    tosendFilename,\n    Num_Dossier,\n    setLink,\n    scanelement\n  } = _ref;\n  const [file, setFile] = useState(\"\");\n  const [filename, setFilename] = useState(titleFilename);\n  const [message, setMessage] = useState(\"\");\n  const [uploadPercentage, setUploadPercentage] = useState(0);\n  const [uploadDone, setuploadDone] = useState(false);\n\n  const onChange = e => {\n    setUploadPercentage(0);\n\n    if (e.target.files[0].type === \"image/jpeg\") {\n      const myRenamedFile = new File([e.target.files[0]], tosendFilename, {\n        type: file.type,\n        lastModified: new Date()\n      });\n      setFile(myRenamedFile);\n      setFilename(tosendFilename);\n    } else {\n      setMessage(\"يرجى اختيار صورة\");\n    }\n  };\n\n  const onUpload = async eve => {\n    eve.preventDefault();\n    const formData = new FormData();\n    formData.append(\"file\", file);\n    if (Num_Dossier) try {\n      fetch(\"http://localhost:3005/upload/\" + Num_Dossier, {\n        method: \"post\",\n        body: formData,\n        onUploadProgress: progressEvent => {\n          setUploadPercentage(parseInt(Math.round(progressEvent.loaded * 100 / progressEvent.total)));\n        }\n      }).then(response => response.json()).then(data => {\n        const {\n          filePath\n        } = data;\n        setMessage(\"File Uploaded\");\n        setuploadDone(true);\n        setLink(filePath, scanelement);\n      }).catch(err => console.log(err));\n    } catch (err) {\n      if (err.response.status === 500) {\n        setMessage(\"يوجد مشكل في الخادم\");\n      } else {\n        setMessage(err.response.data.msg);\n      }\n\n      setUploadPercentage(0);\n    } else setMessage(\"يجب ادخال اسم المستخدم\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [message ? /*#__PURE__*/_jsxDEV(Message, {\n      msg: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 18\n    }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"my-5\",\n      hidden: uploadDone,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"custom-file mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          className: \"custom-file-input\",\n          id: \"customFile\",\n          onChange: onChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"custom-file-label\",\n          htmlFor: \"customFile\",\n          children: filename\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Progress, {\n        percentage: uploadPercentage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onUpload,\n        className: \"btn btn-primary btn-block mt-4\",\n        children: \"\\u062D\\u0641\\u0638\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n\n_s(FileUpload, \"gticzIusBnK5emxuvq2bkeiL4Dc=\");\n\n_c = FileUpload;\nexport default FileUpload;\n\nvar _c;\n\n$RefreshReg$(_c, \"FileUpload\");","map":{"version":3,"names":["React","Fragment","useState","Message","Progress","FileUpload","titleFilename","tosendFilename","Num_Dossier","setLink","scanelement","file","setFile","filename","setFilename","message","setMessage","uploadPercentage","setUploadPercentage","uploadDone","setuploadDone","onChange","e","target","files","type","myRenamedFile","File","lastModified","Date","onUpload","eve","preventDefault","formData","FormData","append","fetch","method","body","onUploadProgress","progressEvent","parseInt","Math","round","loaded","total","then","response","json","data","filePath","catch","err","console","log","status","msg"],"sources":["C:/Users/moknial01/Documents/suivi-dossier-logement2/src/Components/FileUpload/FileUpload.js"],"sourcesContent":["import React, { Fragment, useState } from \"react\";\r\nimport Message from \"../Message/Message\";\r\nimport Progress from \"../ScanDossier/Progress\";\r\n\r\nconst FileUpload = ({\r\n  titleFilename,\r\n  tosendFilename,\r\n  Num_Dossier,\r\n  setLink,\r\n  scanelement,\r\n}) => {\r\n  const [file, setFile] = useState(\"\");\r\n  const [filename, setFilename] = useState(titleFilename);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [uploadPercentage, setUploadPercentage] = useState(0);\r\n  const [uploadDone, setuploadDone] = useState(false);\r\n\r\n  const onChange = (e) => {\r\n    setUploadPercentage(0);\r\n    if (e.target.files[0].type === \"image/jpeg\") {\r\n      const myRenamedFile = new File([e.target.files[0]], tosendFilename, {\r\n        type: file.type,\r\n        lastModified: new Date(),\r\n      });\r\n      setFile(myRenamedFile);\r\n      setFilename(tosendFilename);\r\n    } else {\r\n      setMessage(\"يرجى اختيار صورة\");\r\n    }\r\n  };\r\n\r\n  const onUpload = async (eve) => {\r\n    eve.preventDefault();\r\n    const formData = new FormData();\r\n    formData.append(\"file\", file);\r\n    if (Num_Dossier)\r\n      try {\r\n        fetch(\"http://localhost:3005/upload/\" + Num_Dossier, {\r\n          method: \"post\",\r\n          body: formData,\r\n          onUploadProgress: (progressEvent) => {\r\n            setUploadPercentage(\r\n              parseInt(\r\n                Math.round((progressEvent.loaded * 100) / progressEvent.total)\r\n              )\r\n            );\r\n          },\r\n        })\r\n          .then((response) => response.json())\r\n          .then((data) => {\r\n            const { filePath } = data;\r\n            setMessage(\"File Uploaded\");\r\n            setuploadDone(true);\r\n            setLink(filePath, scanelement);\r\n          })\r\n          .catch((err) => console.log(err));\r\n      } catch (err) {\r\n        if (err.response.status === 500) {\r\n          setMessage(\"يوجد مشكل في الخادم\");\r\n        } else {\r\n          setMessage(err.response.data.msg);\r\n        }\r\n        setUploadPercentage(0);\r\n      }\r\n    else setMessage(\"يجب ادخال اسم المستخدم\");\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      {message ? <Message msg={message} /> : null}\r\n      <div className=\"my-5\" hidden={uploadDone}>\r\n        <div className=\"custom-file mb-4\">\r\n          <input\r\n            type=\"file\"\r\n            className=\"custom-file-input\"\r\n            id=\"customFile\"\r\n            onChange={onChange}\r\n          />\r\n          <label className=\"custom-file-label\" htmlFor=\"customFile\">\r\n            {filename}\r\n          </label>\r\n        </div>\r\n\r\n        <Progress percentage={uploadPercentage} />\r\n\r\n        <button onClick={onUpload} className=\"btn btn-primary btn-block mt-4\">\r\n          حفظ\r\n        </button>\r\n      </div>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default FileUpload;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}